---
title: "Building Tidy Data"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo=TRUE)
```

# Overview

This notebook serves as reference for the tidying procedures used to prepare the
study data for analysis.

# Form the Data Frame

## Load the Raw Data

The raw data is loaded from a CSV file exported from Typeform.

```{r}
# Ignore the first two columns; they are junk.
df <- readr::read_csv('../data/dogs-and-children-survey.csv')

# Assert that the data set is 192 rows and 676 cols.
stopifnot(identical(dim(df)+0, c(192, 676)))
```

We update the data frame column names to be more friendly to work with during
analysis.

```{r}
# Apply analysis friendly column names.
colnames(df) <- readr::read_csv('../data/column-names.csv') %>%
  dplyr::pull('readable')

# Peek at the data.
print(df, n=6)
```

# Drop Unnecessary Columns

We drop columns that will not be used in analysis.

```{r}
df <- df %>%
  select(-c(idx, id, start_date_utc, stage_date_utc, submit_date_utc, tags,
            ending))

# Assert size after dropping columns.
stopifnot(identical(dim(df)+0, c(192, 669)))
```

# Save the Tidy Data    
    
Save the data to a file in the data directory using RDS format so that the data    
types are stored and the resulting file is compressed.    
    
```{r}
saveRDS(df, '../data/tidy.Rds')    
```  

# Display Session Info

```{r}
utils::sessionInfo()
```

